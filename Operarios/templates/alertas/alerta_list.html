{% extends "base.html" %}

{% block content %}
<h1 class='my-3'>Alertas</h1>
<div class="container-fluid">
    <form method="GET" role="form" id="formulario">
            
   
    <div class="col-md-12">
        <div class="card">
            <div class="card-header">
                Filtros de Alertas
            </div>
            <div class="card-body">
                <div class="cuerpo-filtro row">
                    <div class="row filter-row">
                        <div class="col-md-4">
                            <p style="margin:0px !important">

                                <label for="">Fecha inicio:</label>
                                <div class='input-group date' id='datetimepickerfechaDesde'>
                                    <input type='text' class="form-control" name="fechaDesde" value="{{fechaDesde}}"
                                        required />
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                                </div>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p style="margin:0px !important">

                                <label for="">Fecha fin:</label>
                                <div class='input-group date' id='datetimepickerfechaHasta'>
                                    <input type='text' class="form-control" name="fechaHasta" value="{{fechaHasta}}"
                                        required />
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </span>
                                </div>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p> 
                                <label for="">Punto de servicio:</label>
                                <select id="puntoServicio" data-size="5" name="puntoServicio" value="{{puntoServicio}}"  class="selectpicker form-control" data-live-search="true" title="Seleccionar...." >
                    
                                        {% for puntosSer in PuntosServicio %}
                                        {% if puntosSer.id == puntoServicio  %}
                                          <option data-tokens="{{puntosSer.NombrePServicio}}" selected="selected"
                                          value="{{puntosSer.id}}"> {{puntosSer.NombrePServicio}}</option>
                                        {% else %}
                                          <option data-tokens="{{puntosSer.NombrePServicio}}" value="{{puntosSer.id}}"> {{puntosSer.NombrePServicio}}</option>
                    
                                        {% endif %}
                                       {% endfor %}
                                    </select>
                                
                            </p>
                        </div>
                    </div>
                    <div class="row filter-row">
                        <div class="col-md-4">
                            <p>

                                <label for="">Estado:</label>
                                <select class="form-control" id="exampleFormControlSelect1" name="estado" value="{{estado}}">
                                    <option value="'Abierto'" selected>Abierto </option>
                                    <option value="'Pendiente'">Pendiente</option>
                                    <option value="'Cerrado'">Cerrado </option>
                                </select>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p>

                                <label for="tipoAlerta">Tipo de alerta:</label>
                                <select name="tipoAlerta" id="tipoAlerta" class="form-control"
                                    id="exampleFormControlSelect1" name="tipoAlerta" value="{{tipoAlerta}}">
                                    <option value="'No marcacion'" selected>No marcacion</option>
                                    <option value="'Sin asignacion'">Sin asignacion</option>
                                </select>
                            </p>
                        </div>
                        <div class="col-md-4">
                            <p>

                                <label for="">Operario:</label>
                                <select class="form-control" id="exampleFormControlSelect1" name="operario" value="{{operario}}">
                                    {% if operarios %}
                                    <option value="">--- Seleccione un Operario ---</option>
                                    {% for operario in operarios %}
                                    <option value={{ operario.id }}>{{ operario.nombre }} - {{operario.nroLegajo}}
                                    </option>
                                    {% endfor %}
                                    {% endif %}
                                </select>
                            </p>
                        </div>
                    </div>
                </div>
                <div style="    float: right;">
                        <button type='submit' class='btn btn-success'>Filtrar</button>
                    
                    <a href={% url 'Operarios:alertas_list' %} class="btn btn-primary">Limpiar</a>
                </div>

            </div>
        </div>
        <table></table>
        <div class="pagination">
            {% if alertasList.has_previous %}
            <a href="?page={{alertasList.previous_page_number}}">Anterior</a>
            {% else %}
            <span class="disabled">Anterior</span>
            {% endif %}
            {% if alertasList.has_next %}
            <a href="?page={{alertasList.next_page_number}}">Anterior</a>
            {% else %}
            <span class="disabled">Siguiente</span>
            {% endif %}
        </div>
    </div>
</form>

</div>
<script type="text/javascript">
    $(function () {
        $('#datetimepickerfechaDesde').datetimepicker({
            locale: 'es',
            format: 'DD/MM/YYYY', //This is the default date format Django will accept, it also disables the time in the datepicker.
            date: new Date()
        })
    });
    $(function () {
        $('#datetimepickerfechaHasta').datetimepicker({
            locale: 'es',
            format: 'DD/MM/YYYY', //This is the default date format Django will accept, it also disables the time in the datepicker.
            date: new Date()
        })
    });
    function llamarFiltro()
    {
        document.getElementById('action').value = 'filter_operario-' + id;
        //hacemos submit
        document.getElementById('formulario').submit();
    }
    
</script>


<style>
    .card-header {
        background-color: #a52441 !important;
        color: white !important;
        font-size: 20px !important;
        border-radius: 0px !important;
        border-bottom: 1px solid gray !important;
    }

    .cuerpo-filtro .row div p {
        width: 100% !important;
        padding: 0px 10px;
    }

    .filter-row {
        width: 100%;
    }
    .input-group{
        padding: 0px 10px;

    }
</style>
{% endblock %}